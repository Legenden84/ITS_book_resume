# 6.5 â€¡Return-to-libc Exploits

## Overview
Return-to-libc exploits are a category of buffer overflow attacks that circumvent defenses against executing code on the stack or heap by instead manipulating the program to execute existing system code with attacker-controlled parameters.

## Stack-Based Return-to-libc Attack
- **Mechanism**: Instead of pointing a manipulated return address to injected code, it is directed to existing system code, commonly in libc, with parameters set up by the attacker.
- **Common Target - `system()` Function**: 
  - **Usage**: Executes a string as a shell command, with the attacker arranging the stack to pass their desired command string as an argument.
  - **Implementation in Unix**: Involves creating a child process and executing the command, returning after completion.
  - **Attack Setup**: The attacker places their command in the stack location where the invoked library function expects its argument, effectively executing arbitrary commands.
  
## Return-to-libc with `strcpy` of Shellcode
- **Defeating Non-Executable Stacks**: This variant is used when the stack is non-executable, using `strcpy()` instead of `system()`.
- **Mechanism**:
  - **Function Used**: `strcpy()`, which copies a string from a source to a destination address.
  - **Attack Setup**: The attacker arranges the buffer with stack arguments for `strcpy()`, including the shellcode and addresses.
  - **Execution Flow**: The shellcode is copied from the non-executable stack to a writable and executable segment, then executed upon returning from `strcpy()`.
