# 11.3 Sniffers, Reconnaissance Scanners, Vulnerability Scanners
This section explores a range of tools that are pivotal in network security and can be used for both defensive (white-hat) and malicious (black-hat) purposes.

## Packet Sniffing
Packet sniffing tools are essential for Network Intrusion Detection Systems (NIDS), as they capture and store network packets. For an Intrusion Prevention System (IPS), real-time analysis of packets is crucial, whereas for an Intrusion Detection System (IDS), swift processing is important, but it doesn’t have to be inline. Beyond intrusion detection, these tools play a vital role in passive network monitoring, helping to understand network activities, traffic patterns, and usage. This can support network management and aid in forensic investigations post-incident. However, attackers also use sniffing tools, underlining the need for traffic encryption via methods such as SSH, TLS, and IPsec-based VPNs.

## Hubs and Switches
The Ethernet protocol is dominant in wired Local Area Networks (LANs), where hosts communicate via hubs or switches. Hubs broadcast all received packets to all LAN hosts, whereas switches send packets only to the specified destination host. This makes switches more secure, although their security can be compromised through ARP spoofing.

## Monitoring Support: Network Taps and SPANs
Network taps and SPAN (Switched Port Analyzer) ports facilitate passive monitoring. SPANs duplicate traffic from selected ports, while taps are dedicated devices that allow for traffic monitoring between network devices. While both are inline, they don’t process traffic like an IPS. An IPS must be inline to prevent intrusions, whereas an IDS can be passive.

## Vulnerability Assessment Tools
These tools aim to identify weaknesses in a network’s security posture, focusing on three main areas: known-vulnerable services, common configuration errors, and weak default configurations. There are both host-based and network-based tools, with network-based tools falling into three categories: reconnaissance tools, vulnerability scanners, and penetration testing or exploitation toolkits. Authorized parties use these tools for self-evaluation, compliance checks, and understanding network-accessible vulnerabilities. However, exploitation toolkits are often used maliciously to compromise systems.

## Limitations and Cautions
Vulnerability assessments provide a snapshot in time and are limited to the exploits known by the tools. The dual-use nature of exploitation frameworks creates ethical dilemmas, although the consensus is that responsible disclosure is crucial. Unauthorized use of these tools on networks that aren’t your own could lead to legal consequences.

## Port Scanning and OS Fingerprinting
Network-based reconnaissance involves identifying active hosts and open ports, with port scanning tools helping to identify open ports. IPS systems can detect and block port scanning activities. OS fingerprinting helps to identify the operating system and version of remote hosts, aiding in both defense and attack strategies.

## Examples
- **OS Fingerprinting**: Tools like p0f (passive) and Xprobe2 or Nmap (active) help in identifying the operating system of remote hosts.
- **Nmap**: A versatile network scanner used for host discovery, port scanning, OS fingerprinting, and network mapping.
- **Nessus**: A widely-used vulnerability scanner with a large library of plugins for testing individual vulnerabilities.
- **Packet Capture Utilities**: Tools like tcpdump and Wireshark capture and process network packets, supporting network analysis and intrusion detection.

### Attacking the Sniffer
Packet sniffers themselves can be exploited, making software security crucial. The need for root privileges in some systems adds to the risk, highlighting the importance of secure configurations and practices.
